(function(_,he){typeof exports=="object"&&typeof module<"u"?he(exports,require("fast-xml-parser")):typeof define=="function"&&define.amd?define(["exports","fast-xml-parser"],he):(_=typeof globalThis<"u"?globalThis:_||self,he(_.lightningflowscanner={},_["fast-xml-parser"]))})(this,(function(_,he){"use strict";class xe{constructor(){this.visitedElements=new Set}traverseFlow(t,e,n,a){var i;let o=[e];for(;o.length>0;){const s=[];for(const c of o)if(!this.visitedElements.has(c)){const u=(i=t.elements)==null?void 0:i.find(l=>l.name===c);u&&(n(u),this.visitedElements.add(c),s.push(...this.findNextElements(t,u,a)))}if(s.length===0)break;o=s}}findNextElements(t,e,n){var o,i;const a=[];if(!e.connectors||e.connectors.length===0)return a;for(const s of e.connectors){const c=((o=s==null?void 0:s.connectorTargetReference)==null?void 0:o.targetReference)??s.reference,u=(i=t.elements)==null?void 0:i.find(l=>l.metaType==="node"&&l.name===c);u&&u.metaType==="node"&&u.name!==n&&a.push(u.name)}return a}}function Pn(r){var e;const t=[];for(const n of r){const a=n.flow,o=a.label||a.name,i=a.fsPath?a.fsPath.replace(/\\/g,"/"):`${a.name}.flow-meta.xml`;for(const s of n.ruleResults){if(!s.occurs||!((e=s.details)!=null&&e.length))continue;const c=s.ruleDefinition.label||s.ruleName,u=s.severity??"error";for(const l of s.details){const p=l.details||{};t.push({connectsTo:Array.isArray(p.connectsTo)?p.connectsTo.join("; "):p.connectsTo,dataType:p.dataType,expression:p.expression,flowFile:i,flowName:o,locationX:p.locationX,locationY:p.locationY,metaType:l.metaType,name:l.name,ruleName:c,severity:u,type:l.type})}}}return t}function En(r){const t=r.map(e=>{const n=e.flow,a=Fn(n);return{artifacts:[{location:{uri:a},sourceLanguage:"xml"}],results:e.ruleResults.filter(o=>o.occurs).flatMap(o=>o.details.map(i=>({level:tr(o.severity),locations:[{physicalLocation:{artifactLocation:{index:0,uri:a},region:Cn(i,e.flow.toXMLString()||"")}}],message:{text:o.errorMessage||`${o.ruleName} in ${i.name}`},properties:{element:i.name,flow:n.name,type:i.type,...i.details},ruleId:o.ruleName}))),tool:{driver:{informationUri:"https://github.com/Flow-Scanner/lightning-flow-scanner-core",name:"Lightning Flow Scanner",rules:e.ruleResults.filter(o=>o.occurs).map(o=>({defaultConfiguration:{level:tr(o.severity)},fullDescription:{text:o.ruleDefinition.description||""},id:o.ruleName,shortDescription:{text:o.ruleDefinition.description||o.ruleName}})),version:"1.0.0"}}}});return JSON.stringify({$schema:"https://json.schemastore.org/sarif-2.1.0.json",runs:t,version:"2.1.0"},null,2)}function Fn(r){return r.fsPath?r.fsPath.replace(/\\/g,"/"):`flows/${r.name}.flow-meta.xml`}function Cn(r,t=""){if(!t)return{startLine:1,startColumn:1};const e=t.split(`
`),n=r.name;for(let a=0;a<e.length;a++)if(e[a].includes(`<name>${n}</name>`))return{startLine:a+1,startColumn:e[a].indexOf(n)+1};return{startLine:1,startColumn:1}}function tr(r){switch(r==null?void 0:r.toLowerCase()){case"info":case"note":return"note";case"warning":return"warning";default:return"error"}}var rr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function On(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var nr={exports:{}},k=nr.exports={},ee,te;function $e(){throw new Error("setTimeout has not been defined")}function Ve(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?ee=setTimeout:ee=$e}catch{ee=$e}try{typeof clearTimeout=="function"?te=clearTimeout:te=Ve}catch{te=Ve}})();function or(r){if(ee===setTimeout)return setTimeout(r,0);if((ee===$e||!ee)&&setTimeout)return ee=setTimeout,setTimeout(r,0);try{return ee(r,0)}catch{try{return ee.call(null,r,0)}catch{return ee.call(this,r,0)}}}function xn(r){if(te===clearTimeout)return clearTimeout(r);if((te===Ve||!te)&&clearTimeout)return te=clearTimeout,clearTimeout(r);try{return te(r)}catch{try{return te.call(null,r)}catch{return te.call(this,r)}}}var ae=[],me=!1,pe,Ie=-1;function In(){!me||!pe||(me=!1,pe.length?ae=pe.concat(ae):Ie=-1,ae.length&&ir())}function ir(){if(!me){var r=or(In);me=!0;for(var t=ae.length;t;){for(pe=ae,ae=[];++Ie<t;)pe&&pe[Ie].run();Ie=-1,t=ae.length}pe=null,me=!1,xn(r)}}k.nextTick=function(r){var t=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e];ae.push(new ar(r,t)),ae.length===1&&!me&&or(ir)};function ar(r,t){this.fun=r,this.array=t}ar.prototype.run=function(){this.fun.apply(null,this.array)},k.title="browser",k.browser=!0,k.env={},k.argv=[],k.version="",k.versions={};function se(){}k.on=se,k.addListener=se,k.once=se,k.off=se,k.removeListener=se,k.removeAllListeners=se,k.emit=se,k.prependListener=se,k.prependOnceListener=se,k.listeners=function(r){return[]},k.binding=function(r){throw new Error("process.binding is not supported")},k.cwd=function(){return"/"},k.chdir=function(r){throw new Error("process.chdir is not supported")},k.umask=function(){return 0};var jn=nr.exports;const X=On(jn);var Ge,sr;function Bn(){if(sr)return Ge;sr=1;function r(a){if(typeof a!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(a))}function t(a,o){for(var i="",s=0,c=-1,u=0,l,p=0;p<=a.length;++p){if(p<a.length)l=a.charCodeAt(p);else{if(l===47)break;l=47}if(l===47){if(!(c===p-1||u===1))if(c!==p-1&&u===2){if(i.length<2||s!==2||i.charCodeAt(i.length-1)!==46||i.charCodeAt(i.length-2)!==46){if(i.length>2){var d=i.lastIndexOf("/");if(d!==i.length-1){d===-1?(i="",s=0):(i=i.slice(0,d),s=i.length-1-i.lastIndexOf("/")),c=p,u=0;continue}}else if(i.length===2||i.length===1){i="",s=0,c=p,u=0;continue}}o&&(i.length>0?i+="/..":i="..",s=2)}else i.length>0?i+="/"+a.slice(c+1,p):i=a.slice(c+1,p),s=p-c-1;c=p,u=0}else l===46&&u!==-1?++u:u=-1}return i}function e(a,o){var i=o.dir||o.root,s=o.base||(o.name||"")+(o.ext||"");return i?i===o.root?i+s:i+a+s:s}var n={resolve:function(){for(var o="",i=!1,s,c=arguments.length-1;c>=-1&&!i;c--){var u;c>=0?u=arguments[c]:(s===void 0&&(s=X.cwd()),u=s),r(u),u.length!==0&&(o=u+"/"+o,i=u.charCodeAt(0)===47)}return o=t(o,!i),i?o.length>0?"/"+o:"/":o.length>0?o:"."},normalize:function(o){if(r(o),o.length===0)return".";var i=o.charCodeAt(0)===47,s=o.charCodeAt(o.length-1)===47;return o=t(o,!i),o.length===0&&!i&&(o="."),o.length>0&&s&&(o+="/"),i?"/"+o:o},isAbsolute:function(o){return r(o),o.length>0&&o.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var o,i=0;i<arguments.length;++i){var s=arguments[i];r(s),s.length>0&&(o===void 0?o=s:o+="/"+s)}return o===void 0?".":n.normalize(o)},relative:function(o,i){if(r(o),r(i),o===i||(o=n.resolve(o),i=n.resolve(i),o===i))return"";for(var s=1;s<o.length&&o.charCodeAt(s)===47;++s);for(var c=o.length,u=c-s,l=1;l<i.length&&i.charCodeAt(l)===47;++l);for(var p=i.length,d=p-l,E=u<d?u:d,w=-1,g=0;g<=E;++g){if(g===E){if(d>E){if(i.charCodeAt(l+g)===47)return i.slice(l+g+1);if(g===0)return i.slice(l+g)}else u>E&&(o.charCodeAt(s+g)===47?w=g:g===0&&(w=0));break}var A=o.charCodeAt(s+g),F=i.charCodeAt(l+g);if(A!==F)break;A===47&&(w=g)}var v="";for(g=s+w+1;g<=c;++g)(g===c||o.charCodeAt(g)===47)&&(v.length===0?v+="..":v+="/..");return v.length>0?v+i.slice(l+w):(l+=w,i.charCodeAt(l)===47&&++l,i.slice(l))},_makeLong:function(o){return o},dirname:function(o){if(r(o),o.length===0)return".";for(var i=o.charCodeAt(0),s=i===47,c=-1,u=!0,l=o.length-1;l>=1;--l)if(i=o.charCodeAt(l),i===47){if(!u){c=l;break}}else u=!1;return c===-1?s?"/":".":s&&c===1?"//":o.slice(0,c)},basename:function(o,i){if(i!==void 0&&typeof i!="string")throw new TypeError('"ext" argument must be a string');r(o);var s=0,c=-1,u=!0,l;if(i!==void 0&&i.length>0&&i.length<=o.length){if(i.length===o.length&&i===o)return"";var p=i.length-1,d=-1;for(l=o.length-1;l>=0;--l){var E=o.charCodeAt(l);if(E===47){if(!u){s=l+1;break}}else d===-1&&(u=!1,d=l+1),p>=0&&(E===i.charCodeAt(p)?--p===-1&&(c=l):(p=-1,c=d))}return s===c?c=d:c===-1&&(c=o.length),o.slice(s,c)}else{for(l=o.length-1;l>=0;--l)if(o.charCodeAt(l)===47){if(!u){s=l+1;break}}else c===-1&&(u=!1,c=l+1);return c===-1?"":o.slice(s,c)}},extname:function(o){r(o);for(var i=-1,s=0,c=-1,u=!0,l=0,p=o.length-1;p>=0;--p){var d=o.charCodeAt(p);if(d===47){if(!u){s=p+1;break}continue}c===-1&&(u=!1,c=p+1),d===46?i===-1?i=p:l!==1&&(l=1):i!==-1&&(l=-1)}return i===-1||c===-1||l===0||l===1&&i===c-1&&i===s+1?"":o.slice(i,c)},format:function(o){if(o===null||typeof o!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof o);return e("/",o)},parse:function(o){r(o);var i={root:"",dir:"",base:"",ext:"",name:""};if(o.length===0)return i;var s=o.charCodeAt(0),c=s===47,u;c?(i.root="/",u=1):u=0;for(var l=-1,p=0,d=-1,E=!0,w=o.length-1,g=0;w>=u;--w){if(s=o.charCodeAt(w),s===47){if(!E){p=w+1;break}continue}d===-1&&(E=!1,d=w+1),s===46?l===-1?l=w:g!==1&&(g=1):l!==-1&&(g=-1)}return l===-1||d===-1||g===0||g===1&&l===d-1&&l===p+1?d!==-1&&(p===0&&c?i.base=i.name=o.slice(1,d):i.base=i.name=o.slice(p,d)):(p===0&&c?(i.name=o.slice(1,l),i.base=o.slice(1,d)):(i.name=o.slice(p,l),i.base=o.slice(p,d)),i.ext=o.slice(l,d)),p>0?i.dir=o.slice(0,p-1):c&&(i.dir="/"),i},sep:"/",delimiter:":",win32:null,posix:null};return n.posix=n,Ge=n,Ge}var Ae=Bn();class Se{constructor(t,e,n){this.element={},this.element=n,this.subtype=e,this.metaType=t}}class cr extends Se{constructor(t,e){super("metadata",t,e)}}class q{constructor(t,e,n){this.element={},this.processed=!1,this.type=t,this.element=e,this.childName=n.childName?n.childName:void 0,this.childOf=n.childOf?n.childOf:void 0,e&&"targetReference"in e&&(this.reference=e.targetReference),e&&"connector"in e&&(this.connectorTargetReference=e.connector)}}class re extends Se{constructor(t,e,n){super("node",e,n),this.connectors=[];const a=e==="start"?"flowstart":t;this.name=a;const o=this.getConnectors(e,n);this.connectors=o,this.locationX=n.locationX,this.locationY=n.locationY}getConnectors(t,e){const n=[];if(t==="start"){if(e.connector&&n.push(new q("connector",e.connector,{})),Array.isArray(e.scheduledPaths))for(const a of(e==null?void 0:e.scheduledPaths)||[])a.connector&&n.push(new q("connector",a.connector,{childName:(a==null?void 0:a.name)??"AsyncAfterCommit",childOf:"scheduledPaths"}));else e.scheduledPaths&&n.push(new q("connector",e.scheduledPaths,{childName:e.scheduledPaths.name,childOf:"scheduledPaths"}));return n}else if(t==="decisions"){if(e.defaultConnector&&n.push(new q("defaultConnector",e.defaultConnector,{})),e.rules)if(Array.isArray(e.rules))for(const a of e.rules)a.connector&&n.push(new q("connector",a.connector,{childName:a.name,childOf:"rules"}));else e.rules.connector&&n.push(new q("connector",e.rules.connector,{childName:e.rules.name,childOf:"rules"}));return n}else{if(t==="assignments"||t==="transforms"||t==="customErrors")return e.connector?[new q("connector",e.connector,{})]:[];if(t==="loops")return e.nextValueConnector&&n.push(new q("nextValueConnector",e.nextValueConnector,{})),e.noMoreValuesConnector&&n.push(new q("noMoreValuesConnector",e.noMoreValuesConnector,{})),n;if(t==="actionCalls")return e.connector&&n.push(new q("connector",e.connector,{})),e.faultConnector&&n.push(new q("faultConnector",e.faultConnector,{})),n;if(t==="waits"){if(e.defaultConnector&&n.push(new q("defaultConnector",e.defaultConnector,{})),e.faultConnector&&n.push(new q("faultConnector",e.faultConnector,{})),Array.isArray(e.waitEvents))for(const a of e.waitEvents)a.connector&&n.push(new q("connector",a.connector,{childName:a.name,childOf:"waitEvents"}));return n}else return t==="recordCreates"?(e.connector&&n.push(new q("connector",e.connector,{})),e.faultConnector&&n.push(new q("faultConnector",e.faultConnector,{})),n):t==="recordDeletes"?(e.connector&&n.push(new q("connector",e.connector,{})),e.faultConnector&&n.push(new q("faultConnector",e.faultConnector,{})),n):t==="recordLookups"?(e.connector&&n.push(new q("connector",e.connector,{})),e.faultConnector&&n.push(new q("faultConnector",e.faultConnector,{})),n):t==="recordUpdates"?(e.connector&&n.push(new q("connector",e.connector,{})),e.faultConnector&&n.push(new q("faultConnector",e.faultConnector,{})),n):t==="subflows"?e.connector?[new q("connector",e.connector,{})]:[]:t==="screens"?e.connector?[new q("connector",e.connector,{})]:[]:e.connector?[new q("connector",e.connector,{})]:[]}}}class je extends Se{constructor(t,e,n){super("resource",e,n),this.name=t}}class Re extends Se{constructor(t,e,n){super("variable",e,n),this.name=t,this.dataType=n.dataType}}class We{constructor(t,e){if(this.flowMetadata=["description","apiVersion","processMetadataValues","processType","interviewLabel","label","status","runInMode","startElementReference","isTemplate","fullName","timeZoneSidKey","isAdditionalPermissionRequiredToRun","migratedFromWorkflowRuleName","triggerOrder","environments","segment"],this.flowNodes=["actionCalls","apexPluginCalls","assignments","collectionProcessors","decisions","loops","orchestratedStages","recordCreates","recordDeletes","recordLookups","recordUpdates","recordRollbacks","screens","start","steps","subflows","waits","transforms","customErrors"],this.flowResources=["textTemplates","stages"],this.flowVariables=["choices","constants","dynamicChoiceSets","formulas","variables"],t){this.fsPath=Ae.resolve(t);let n=Ae.basename(Ae.basename(this.fsPath),Ae.extname(this.fsPath));n.includes(".")&&(n=n.split(".")[0]),this.name=n}e&&(typeof e=="object"&&"Flow"in e?this.xmldata=e.Flow:this.xmldata=e,this.preProcessNodes())}preProcessNodes(){this.label=this.xmldata.label,this.interviewLabel=this.xmldata.interviewLabel,this.processType=this.xmldata.processType,this.processMetadataValues=this.xmldata.processMetadataValues,this.startElementReference=this.xmldata.startElementReference,this.start=this.xmldata.start,this.status=this.xmldata.status,this.type=this.xmldata.processType,this.triggerOrder=this.xmldata.triggerOrder;const t=[];for(const e in this.xmldata){if(e.startsWith("@_")||e==="@xmlns")continue;const n=this.xmldata[e];if(this.flowMetadata.includes(e))if(Array.isArray(n))for(const a of n)t.push(new cr(e,a));else t.push(new cr(e,n));else if(this.flowVariables.includes(e))if(Array.isArray(n))for(const a of n)t.push(new Re(a.name,e,a));else t.push(new Re(n.name,e,n));else if(this.flowNodes.includes(e))if(Array.isArray(n))for(const a of n)t.push(new re(a.name,e,a));else t.push(new re(n.name,e,n));else if(this.flowResources.includes(e))if(Array.isArray(n))for(const a of n)t.push(new je(a.name,e,a));else t.push(new je(n.name,e,n))}this.elements=t,this.startReference=this.findStart()}toXMLString(){try{return this.generateDoc()}catch(t){return console.warn(`Unable to write xml, caught an error ${t.toString()}`),""}}findStart(){let t="";const e=this.elements.filter(n=>n instanceof re);return this.startElementReference?t=this.startElementReference:e.find(n=>n.subtype==="start")&&(t=e.find(a=>a.subtype==="start").connectors[0].reference),t}generateDoc(){const t="http://soap.sforce.com/2006/04/metadata",e={format:!0,ignoreAttributes:!1,attributeNamePrefix:"@_",suppressEmptyNode:!1,suppressBooleanAttributes:!1},n=new he.XMLBuilder(e),a={...this.xmldata};a["@_xmlns"]||(a["@_xmlns"]=t),a["@_xmlns:xsi"]||(a["@_xmlns:xsi"]="http://www.w3.org/2001/XMLSchema-instance");const o={Flow:a};return n.build(o)}}class Z{constructor(t,e,n){this.metaType="attribute",this.name=t,this.subtype=e,this.expression=n}}const ne=class ne{};ne.autolaunchedType="AutoLaunchedFlow",ne.backEndTypes=[ne.autolaunchedType,"CustomEvent","InvocableProcess","Orchestrator","EvaluationFlow","ActionCadenceAutolaunchedFlow"],ne.processBuilder=["Workflow"],ne.surveyTypes=["Survey"],ne.unsupportedTypes=["CheckoutFlow","FSCLending","FSCLending","LoyaltyManagementFlow"],ne.visualTypes=["Flow","IndividualObjectLinkingFlow","LoginFlow","RoutingFlow","Appointments","ActionCadenceStepFlow","ContactRequestFlow","ContactRequestFlow","CustomerLifecycle","FieldServiceMobile","FieldServiceWeb","SurveyEnrich"],ne.allTypes=function(){return[...this.backEndTypes,...this.visualTypes,...this.surveyTypes]};let x=ne;class U{constructor(t){var e;if(this.violation=t,this.name=t.name,this.metaType=t.metaType,this.type=t.subtype,t.metaType==="variable"){const n=t;this.details={dataType:n.dataType}}if(t.metaType==="node"){const n=t;this.details={locationX:n.locationX,locationY:n.locationY,connectsTo:(e=n.connectors)==null?void 0:e.map(a=>a.reference)}}if(t.metaType==="attribute"){const n=t;this.details={expression:n.expression}}}}class P{constructor(t,e,n){this.details=[],this.ruleDefinition=t,this.ruleName=t.name,this.severity=t.severity?t.severity:"error",this.occurs=!1,this.details=e,e.length>0&&(this.occurs=!0),n&&(this.errorMessage=n)}}class ze{constructor(t,e){this.flow=t,this.ruleResults=e}}class Nn{constructor(t,e){this.docRefs=[],this.name=t.name,this.supportedTypes=t.supportedTypes,this.label=t.label,this.description=t.description,this.uri=`https://github.com/Lightning-Flow-Scanner/lightning-flow-scanner-core/tree/main/src/main/rules/${t.name}.ts`,this.docRefs=t.docRefs,this.isConfigurable=t.isConfigurable,this.autoFixable=t.autoFixable,this.severity=(e==null?void 0:e.severity)??"error",this.suppressionElement=t.suppressionElement}}class He{constructor(t,e,n){this.uri=t,this.flow=e,n&&(this.errorMessage=n)}}function Dn(r,t,e){return r[e]=t.map(n=>n.element),r}function _n(r){let t={};for(const e of r){const n=e.subtype,a=r.filter(o=>n===o.subtype);t=Dn(t,a,n)}return t}function qn(r){const t=[];for(const e of r){if(!e.ruleResults||e.ruleResults.length===0)continue;const n=e.ruleResults.filter(i=>i.ruleName==="UnusedVariable"&&i.occurs||i.ruleName==="UnconnectedElement"&&i.occurs);if(n.length===0)continue;const a=Un(e.flow,n);a.elements&&a.elements.length>0&&(e.flow=a,t.push(e))}return t}function Un(r,t){var c,u,l;const e=t.find(p=>p.ruleName==="UnusedVariable"),n=new Set(((c=e==null?void 0:e.details)==null?void 0:c.map(p=>p.name))??[]),a=t.find(p=>p.ruleName==="UnconnectedElement"),o=new Set(((u=a==null?void 0:a.details)==null?void 0:u.map(p=>p.name))??[]),i=((l=r.elements)==null?void 0:l.filter(p=>{switch(p.metaType){case"metadata":case"resource":return!0;case"node":{const d=p;return!o.has(d.name)}case"variable":{const d=p;return!n.has(d.name)}default:return!1}}))??[],s=_n(i);return new We(r.fsPath,s)}var Je={},Qe={},Xe,lr;function ur(){return lr||(lr=1,Xe=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},e=Symbol("test"),n=Object(e);if(typeof e=="string"||Object.prototype.toString.call(e)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var a=42;t[e]=a;for(var o in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var i=Object.getOwnPropertySymbols(t);if(i.length!==1||i[0]!==e||!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(t,e);if(s.value!==a||s.enumerable!==!0)return!1}return!0}),Xe}var Ye,fr;function Be(){if(fr)return Ye;fr=1;var r=ur();return Ye=function(){return r()&&!!Symbol.toStringTag},Ye}var Ze,pr;function dr(){return pr||(pr=1,Ze=Object),Ze}var Ke,yr;function Mn(){return yr||(yr=1,Ke=Error),Ke}var et,hr;function kn(){return hr||(hr=1,et=EvalError),et}var tt,mr;function Ln(){return mr||(mr=1,tt=RangeError),tt}var rt,gr;function $n(){return gr||(gr=1,rt=ReferenceError),rt}var nt,vr;function br(){return vr||(vr=1,nt=SyntaxError),nt}var ot,wr;function Te(){return wr||(wr=1,ot=TypeError),ot}var it,Ar;function Vn(){return Ar||(Ar=1,it=URIError),it}var at,Sr;function Gn(){return Sr||(Sr=1,at=Math.abs),at}var st,Rr;function Wn(){return Rr||(Rr=1,st=Math.floor),st}var ct,Tr;function zn(){return Tr||(Tr=1,ct=Math.max),ct}var lt,Pr;function Hn(){return Pr||(Pr=1,lt=Math.min),lt}var ut,Er;function Jn(){return Er||(Er=1,ut=Math.pow),ut}var ft,Fr;function Qn(){return Fr||(Fr=1,ft=Math.round),ft}var pt,Cr;function Xn(){return Cr||(Cr=1,pt=Number.isNaN||function(t){return t!==t}),pt}var dt,Or;function Yn(){if(Or)return dt;Or=1;var r=Xn();return dt=function(e){return r(e)||e===0?e:e<0?-1:1},dt}var yt,xr;function Zn(){return xr||(xr=1,yt=Object.getOwnPropertyDescriptor),yt}var ht,Ir;function ge(){if(Ir)return ht;Ir=1;var r=Zn();if(r)try{r([],"length")}catch{r=null}return ht=r,ht}var mt,jr;function Ne(){if(jr)return mt;jr=1;var r=Object.defineProperty||!1;if(r)try{r({},"a",{value:1})}catch{r=!1}return mt=r,mt}var gt,Br;function Kn(){if(Br)return gt;Br=1;var r=typeof Symbol<"u"&&Symbol,t=ur();return gt=function(){return typeof r!="function"||typeof Symbol!="function"||typeof r("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:t()},gt}var vt,Nr;function Dr(){return Nr||(Nr=1,vt=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),vt}var bt,_r;function qr(){if(_r)return bt;_r=1;var r=dr();return bt=r.getPrototypeOf||null,bt}var wt,Ur;function eo(){if(Ur)return wt;Ur=1;var r="Function.prototype.bind called on incompatible ",t=Object.prototype.toString,e=Math.max,n="[object Function]",a=function(c,u){for(var l=[],p=0;p<c.length;p+=1)l[p]=c[p];for(var d=0;d<u.length;d+=1)l[d+c.length]=u[d];return l},o=function(c,u){for(var l=[],p=u,d=0;p<c.length;p+=1,d+=1)l[d]=c[p];return l},i=function(s,c){for(var u="",l=0;l<s.length;l+=1)u+=s[l],l+1<s.length&&(u+=c);return u};return wt=function(c){var u=this;if(typeof u!="function"||t.apply(u)!==n)throw new TypeError(r+u);for(var l=o(arguments,1),p,d=function(){if(this instanceof p){var F=u.apply(this,a(l,arguments));return Object(F)===F?F:this}return u.apply(c,a(l,arguments))},E=e(0,u.length-l.length),w=[],g=0;g<E;g++)w[g]="$"+g;if(p=Function("binder","return function ("+i(w,",")+"){ return binder.apply(this,arguments); }")(d),u.prototype){var A=function(){};A.prototype=u.prototype,p.prototype=new A,A.prototype=null}return p},wt}var At,Mr;function Pe(){if(Mr)return At;Mr=1;var r=eo();return At=Function.prototype.bind||r,At}var St,kr;function Rt(){return kr||(kr=1,St=Function.prototype.call),St}var Tt,Lr;function Pt(){return Lr||(Lr=1,Tt=Function.prototype.apply),Tt}var Et,$r;function to(){return $r||($r=1,Et=typeof Reflect<"u"&&Reflect&&Reflect.apply),Et}var Ft,Vr;function Gr(){if(Vr)return Ft;Vr=1;var r=Pe(),t=Pt(),e=Rt(),n=to();return Ft=n||r.call(e,t),Ft}var Ct,Wr;function Ot(){if(Wr)return Ct;Wr=1;var r=Pe(),t=Te(),e=Rt(),n=Gr();return Ct=function(o){if(o.length<1||typeof o[0]!="function")throw new t("a function is required");return n(r,e,o)},Ct}var xt,zr;function ro(){if(zr)return xt;zr=1;var r=Ot(),t=ge(),e;try{e=[].__proto__===Array.prototype}catch(i){if(!i||typeof i!="object"||!("code"in i)||i.code!=="ERR_PROTO_ACCESS")throw i}var n=!!e&&t&&t(Object.prototype,"__proto__"),a=Object,o=a.getPrototypeOf;return xt=n&&typeof n.get=="function"?r([n.get]):typeof o=="function"?function(s){return o(s==null?s:a(s))}:!1,xt}var It,Hr;function jt(){if(Hr)return It;Hr=1;var r=Dr(),t=qr(),e=ro();return It=r?function(a){return r(a)}:t?function(a){if(!a||typeof a!="object"&&typeof a!="function")throw new TypeError("getProto: not an object");return t(a)}:e?function(a){return e(a)}:null,It}var Bt,Jr;function Qr(){if(Jr)return Bt;Jr=1;var r=Function.prototype.call,t=Object.prototype.hasOwnProperty,e=Pe();return Bt=e.call(r,t),Bt}var Nt,Xr;function Yr(){if(Xr)return Nt;Xr=1;var r,t=dr(),e=Mn(),n=kn(),a=Ln(),o=$n(),i=br(),s=Te(),c=Vn(),u=Gn(),l=Wn(),p=zn(),d=Hn(),E=Jn(),w=Qn(),g=Yn(),A=Function,F=function(R){try{return A('"use strict"; return ('+R+").constructor;")()}catch{}},v=ge(),S=Ne(),D=function(){throw new s},J=v?(function(){try{return arguments.callee,D}catch{try{return v(arguments,"callee").get}catch{return D}}})():D,z=Kn()(),B=jt(),ce=qr(),oe=Dr(),le=Pt(),Q=Rt(),G={},Ce=typeof Uint8Array>"u"||!B?r:B(Uint8Array),W={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?r:ArrayBuffer,"%ArrayIteratorPrototype%":z&&B?B([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":G,"%AsyncGenerator%":G,"%AsyncGeneratorFunction%":G,"%AsyncIteratorPrototype%":G,"%Atomics%":typeof Atomics>"u"?r:Atomics,"%BigInt%":typeof BigInt>"u"?r:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?r:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":e,"%eval%":eval,"%EvalError%":n,"%Float16Array%":typeof Float16Array>"u"?r:Float16Array,"%Float32Array%":typeof Float32Array>"u"?r:Float32Array,"%Float64Array%":typeof Float64Array>"u"?r:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?r:FinalizationRegistry,"%Function%":A,"%GeneratorFunction%":G,"%Int8Array%":typeof Int8Array>"u"?r:Int8Array,"%Int16Array%":typeof Int16Array>"u"?r:Int16Array,"%Int32Array%":typeof Int32Array>"u"?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":z&&B?B(B([][Symbol.iterator]())):r,"%JSON%":typeof JSON=="object"?JSON:r,"%Map%":typeof Map>"u"?r:Map,"%MapIteratorPrototype%":typeof Map>"u"||!z||!B?r:B(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":t,"%Object.getOwnPropertyDescriptor%":v,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?r:Promise,"%Proxy%":typeof Proxy>"u"?r:Proxy,"%RangeError%":a,"%ReferenceError%":o,"%Reflect%":typeof Reflect>"u"?r:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?r:Set,"%SetIteratorPrototype%":typeof Set>"u"||!z||!B?r:B(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":z&&B?B(""[Symbol.iterator]()):r,"%Symbol%":z?Symbol:r,"%SyntaxError%":i,"%ThrowTypeError%":J,"%TypedArray%":Ce,"%TypeError%":s,"%Uint8Array%":typeof Uint8Array>"u"?r:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?r:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?r:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?r:Uint32Array,"%URIError%":c,"%WeakMap%":typeof WeakMap>"u"?r:WeakMap,"%WeakRef%":typeof WeakRef>"u"?r:WeakRef,"%WeakSet%":typeof WeakSet>"u"?r:WeakSet,"%Function.prototype.call%":Q,"%Function.prototype.apply%":le,"%Object.defineProperty%":S,"%Object.getPrototypeOf%":ce,"%Math.abs%":u,"%Math.floor%":l,"%Math.max%":p,"%Math.min%":d,"%Math.pow%":E,"%Math.round%":w,"%Math.sign%":g,"%Reflect.getPrototypeOf%":oe};if(B)try{null.error}catch(R){var de=B(B(R));W["%Error.prototype%"]=de}var ue=function R(b){var j;if(b==="%AsyncFunction%")j=F("async function () {}");else if(b==="%GeneratorFunction%")j=F("function* () {}");else if(b==="%AsyncGeneratorFunction%")j=F("async function* () {}");else if(b==="%AsyncGenerator%"){var N=R("%AsyncGeneratorFunction%");N&&(j=N.prototype)}else if(b==="%AsyncIteratorPrototype%"){var L=R("%AsyncGenerator%");L&&B&&(j=B(L.prototype))}return W[b]=j,j},ve={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Y=Pe(),H=Qr(),fe=Y.call(Q,Array.prototype.concat),be=Y.call(le,Array.prototype.splice),f=Y.call(Q,String.prototype.replace),y=Y.call(Q,String.prototype.slice),m=Y.call(Q,RegExp.prototype.exec),T=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,O=/\\(\\)?/g,I=function(b){var j=y(b,0,1),N=y(b,-1);if(j==="%"&&N!=="%")throw new i("invalid intrinsic syntax, expected closing `%`");if(N==="%"&&j!=="%")throw new i("invalid intrinsic syntax, expected opening `%`");var L=[];return f(b,T,function($,K,V,we){L[L.length]=V?f(we,O,"$1"):K||$}),L},C=function(b,j){var N=b,L;if(H(ve,N)&&(L=ve[N],N="%"+L[0]+"%"),H(W,N)){var $=W[N];if($===G&&($=ue(N)),typeof $>"u"&&!j)throw new s("intrinsic "+b+" exists, but is not available. Please file an issue!");return{alias:L,name:N,value:$}}throw new i("intrinsic "+b+" does not exist!")};return Nt=function(b,j){if(typeof b!="string"||b.length===0)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof j!="boolean")throw new s('"allowMissing" argument must be a boolean');if(m(/^%?[^%]*%?$/,b)===null)throw new i("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var N=I(b),L=N.length>0?N[0]:"",$=C("%"+L+"%",j),K=$.name,V=$.value,we=!1,Oe=$.alias;Oe&&(L=Oe[0],be(N,fe([0,1],Oe)));for(var h=1,ye=!0;h<N.length;h+=1){var ie=N[h],Me=y(ie,0,1),ke=y(ie,-1);if((Me==='"'||Me==="'"||Me==="`"||ke==='"'||ke==="'"||ke==="`")&&Me!==ke)throw new i("property names with quotes must have matching quotes");if((ie==="constructor"||!ye)&&(we=!0),L+="."+ie,K="%"+L+"%",H(W,K))V=W[K];else if(V!=null){if(!(ie in V)){if(!j)throw new s("base intrinsic for "+b+" exists, but the property is not available.");return}if(v&&h+1>=N.length){var Le=v(V,ie);ye=!!Le,ye&&"get"in Le&&!("originalValue"in Le.get)?V=Le.get:V=V[ie]}else ye=H(V,ie),V=V[ie];ye&&!we&&(W[K]=V)}}return V},Nt}var Dt,Zr;function Ee(){if(Zr)return Dt;Zr=1;var r=Yr(),t=Ot(),e=t([r("%String.prototype.indexOf%")]);return Dt=function(a,o){var i=r(a,!!o);return typeof i=="function"&&e(a,".prototype.")>-1?t([i]):i},Dt}var _t,Kr;function no(){if(Kr)return _t;Kr=1;var r=Be()(),t=Ee(),e=t("Object.prototype.toString"),n=function(s){return r&&s&&typeof s=="object"&&Symbol.toStringTag in s?!1:e(s)==="[object Arguments]"},a=function(s){return n(s)?!0:s!==null&&typeof s=="object"&&"length"in s&&typeof s.length=="number"&&s.length>=0&&e(s)!=="[object Array]"&&"callee"in s&&e(s.callee)==="[object Function]"},o=(function(){return n(arguments)})();return n.isLegacyArguments=a,_t=o?n:a,_t}var qt,en;function oo(){if(en)return qt;en=1;var r=Ee(),t=Be()(),e=Qr(),n=ge(),a;if(t){var o=r("RegExp.prototype.exec"),i={},s=function(){throw i},c={toString:s,valueOf:s};typeof Symbol.toPrimitive=="symbol"&&(c[Symbol.toPrimitive]=s),a=function(d){if(!d||typeof d!="object")return!1;var E=n(d,"lastIndex"),w=E&&e(E,"value");if(!w)return!1;try{o(d,c)}catch(g){return g===i}}}else{var u=r("Object.prototype.toString"),l="[object RegExp]";a=function(d){return!d||typeof d!="object"&&typeof d!="function"?!1:u(d)===l}}return qt=a,qt}var Ut,tn;function io(){if(tn)return Ut;tn=1;var r=Ee(),t=oo(),e=r("RegExp.prototype.exec"),n=Te();return Ut=function(o){if(!t(o))throw new n("`regex` must be a RegExp");return function(s){return e(o,s)!==null}},Ut}var Mt,rn;function ao(){if(rn)return Mt;rn=1;const r=(function*(){}).constructor;return Mt=()=>r,Mt}var kt,nn;function so(){if(nn)return kt;nn=1;var r=Ee(),t=io(),e=t(/^\s*(?:function)?\*/),n=Be()(),a=jt(),o=r("Object.prototype.toString"),i=r("Function.prototype.toString"),s=ao();return kt=function(u){if(typeof u!="function")return!1;if(e(i(u)))return!0;if(!n){var l=o(u);return l==="[object GeneratorFunction]"}if(!a)return!1;var p=s();return p&&a(u)===p.prototype},kt}var Lt,on;function co(){if(on)return Lt;on=1;var r=Function.prototype.toString,t=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,e,n;if(typeof t=="function"&&typeof Object.defineProperty=="function")try{e=Object.defineProperty({},"length",{get:function(){throw n}}),n={},t(function(){throw 42},null,e)}catch(v){v!==n&&(t=null)}else t=null;var a=/^\s*class\b/,o=function(S){try{var D=r.call(S);return a.test(D)}catch{return!1}},i=function(S){try{return o(S)?!1:(r.call(S),!0)}catch{return!1}},s=Object.prototype.toString,c="[object Object]",u="[object Function]",l="[object GeneratorFunction]",p="[object HTMLAllCollection]",d="[object HTML document.all class]",E="[object HTMLCollection]",w=typeof Symbol=="function"&&!!Symbol.toStringTag,g=!(0 in[,]),A=function(){return!1};if(typeof document=="object"){var F=document.all;s.call(F)===s.call(document.all)&&(A=function(S){if((g||!S)&&(typeof S>"u"||typeof S=="object"))try{var D=s.call(S);return(D===p||D===d||D===E||D===c)&&S("")==null}catch{}return!1})}return Lt=t?function(S){if(A(S))return!0;if(!S||typeof S!="function"&&typeof S!="object")return!1;try{t(S,null,e)}catch(D){if(D!==n)return!1}return!o(S)&&i(S)}:function(S){if(A(S))return!0;if(!S||typeof S!="function"&&typeof S!="object")return!1;if(w)return i(S);if(o(S))return!1;var D=s.call(S);return D!==u&&D!==l&&!/^\[object HTML/.test(D)?!1:i(S)},Lt}var $t,an;function lo(){if(an)return $t;an=1;var r=co(),t=Object.prototype.toString,e=Object.prototype.hasOwnProperty,n=function(c,u,l){for(var p=0,d=c.length;p<d;p++)e.call(c,p)&&(l==null?u(c[p],p,c):u.call(l,c[p],p,c))},a=function(c,u,l){for(var p=0,d=c.length;p<d;p++)l==null?u(c.charAt(p),p,c):u.call(l,c.charAt(p),p,c)},o=function(c,u,l){for(var p in c)e.call(c,p)&&(l==null?u(c[p],p,c):u.call(l,c[p],p,c))};function i(s){return t.call(s)==="[object Array]"}return $t=function(c,u,l){if(!r(u))throw new TypeError("iterator must be a function");var p;arguments.length>=3&&(p=l),i(c)?n(c,u,p):typeof c=="string"?a(c,u,p):o(c,u,p)},$t}var Vt,sn;function uo(){return sn||(sn=1,Vt=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),Vt}var Gt,cn;function fo(){if(cn)return Gt;cn=1;var r=uo(),t=typeof globalThis>"u"?rr:globalThis;return Gt=function(){for(var n=[],a=0;a<r.length;a++)typeof t[r[a]]=="function"&&(n[n.length]=r[a]);return n},Gt}var Wt={exports:{}},zt,ln;function po(){if(ln)return zt;ln=1;var r=Ne(),t=br(),e=Te(),n=ge();return zt=function(o,i,s){if(!o||typeof o!="object"&&typeof o!="function")throw new e("`obj` must be an object or a function`");if(typeof i!="string"&&typeof i!="symbol")throw new e("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new e("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new e("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new e("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new e("`loose`, if provided, must be a boolean");var c=arguments.length>3?arguments[3]:null,u=arguments.length>4?arguments[4]:null,l=arguments.length>5?arguments[5]:null,p=arguments.length>6?arguments[6]:!1,d=!!n&&n(o,i);if(r)r(o,i,{configurable:l===null&&d?d.configurable:!l,enumerable:c===null&&d?d.enumerable:!c,value:s,writable:u===null&&d?d.writable:!u});else if(p||!c&&!u&&!l)o[i]=s;else throw new t("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},zt}var Ht,un;function yo(){if(un)return Ht;un=1;var r=Ne(),t=function(){return!!r};return t.hasArrayLengthDefineBug=function(){if(!r)return null;try{return r([],"length",{value:1}).length!==1}catch{return!0}},Ht=t,Ht}var Jt,fn;function ho(){if(fn)return Jt;fn=1;var r=Yr(),t=po(),e=yo()(),n=ge(),a=Te(),o=r("%Math.floor%");return Jt=function(s,c){if(typeof s!="function")throw new a("`fn` is not a function");if(typeof c!="number"||c<0||c>4294967295||o(c)!==c)throw new a("`length` must be a positive 32-bit integer");var u=arguments.length>2&&!!arguments[2],l=!0,p=!0;if("length"in s&&n){var d=n(s,"length");d&&!d.configurable&&(l=!1),d&&!d.writable&&(p=!1)}return(l||p||!u)&&(e?t(s,"length",c,!0,!0):t(s,"length",c)),s},Jt}var Qt,pn;function mo(){if(pn)return Qt;pn=1;var r=Pe(),t=Pt(),e=Gr();return Qt=function(){return e(r,t,arguments)},Qt}var dn;function go(){return dn||(dn=1,(function(r){var t=ho(),e=Ne(),n=Ot(),a=mo();r.exports=function(i){var s=n(arguments),c=i.length-(arguments.length-1);return t(s,1+(c>0?c:0),!0)},e?e(r.exports,"apply",{value:a}):r.exports.apply=a})(Wt)),Wt.exports}var Xt,yn;function hn(){if(yn)return Xt;yn=1;var r=lo(),t=fo(),e=go(),n=Ee(),a=ge(),o=jt(),i=n("Object.prototype.toString"),s=Be()(),c=typeof globalThis>"u"?rr:globalThis,u=t(),l=n("String.prototype.slice"),p=n("Array.prototype.indexOf",!0)||function(A,F){for(var v=0;v<A.length;v+=1)if(A[v]===F)return v;return-1},d={__proto__:null};s&&a&&o?r(u,function(g){var A=new c[g];if(Symbol.toStringTag in A&&o){var F=o(A),v=a(F,Symbol.toStringTag);if(!v&&F){var S=o(F);v=a(S,Symbol.toStringTag)}d["$"+g]=e(v.get)}}):r(u,function(g){var A=new c[g],F=A.slice||A.set;F&&(d["$"+g]=e(F))});var E=function(A){var F=!1;return r(d,function(v,S){if(!F)try{"$"+v(A)===S&&(F=l(S,1))}catch{}}),F},w=function(A){var F=!1;return r(d,function(v,S){if(!F)try{v(A),F=l(S,1)}catch{}}),F};return Xt=function(A){if(!A||typeof A!="object")return!1;if(!s){var F=l(i(A),8,-1);return p(u,F)>-1?F:F!=="Object"?!1:w(A)}return a?E(A):null},Xt}var Yt,mn;function vo(){if(mn)return Yt;mn=1;var r=hn();return Yt=function(e){return!!r(e)},Yt}var gn;function bo(){return gn||(gn=1,(function(r){var t=no(),e=so(),n=hn(),a=vo();function o(h){return h.call.bind(h)}var i=typeof BigInt<"u",s=typeof Symbol<"u",c=o(Object.prototype.toString),u=o(Number.prototype.valueOf),l=o(String.prototype.valueOf),p=o(Boolean.prototype.valueOf);if(i)var d=o(BigInt.prototype.valueOf);if(s)var E=o(Symbol.prototype.valueOf);function w(h,ye){if(typeof h!="object")return!1;try{return ye(h),!0}catch{return!1}}r.isArgumentsObject=t,r.isGeneratorFunction=e,r.isTypedArray=a;function g(h){return typeof Promise<"u"&&h instanceof Promise||h!==null&&typeof h=="object"&&typeof h.then=="function"&&typeof h.catch=="function"}r.isPromise=g;function A(h){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(h):a(h)||y(h)}r.isArrayBufferView=A;function F(h){return n(h)==="Uint8Array"}r.isUint8Array=F;function v(h){return n(h)==="Uint8ClampedArray"}r.isUint8ClampedArray=v;function S(h){return n(h)==="Uint16Array"}r.isUint16Array=S;function D(h){return n(h)==="Uint32Array"}r.isUint32Array=D;function J(h){return n(h)==="Int8Array"}r.isInt8Array=J;function z(h){return n(h)==="Int16Array"}r.isInt16Array=z;function B(h){return n(h)==="Int32Array"}r.isInt32Array=B;function ce(h){return n(h)==="Float32Array"}r.isFloat32Array=ce;function oe(h){return n(h)==="Float64Array"}r.isFloat64Array=oe;function le(h){return n(h)==="BigInt64Array"}r.isBigInt64Array=le;function Q(h){return n(h)==="BigUint64Array"}r.isBigUint64Array=Q;function G(h){return c(h)==="[object Map]"}G.working=typeof Map<"u"&&G(new Map);function Ce(h){return typeof Map>"u"?!1:G.working?G(h):h instanceof Map}r.isMap=Ce;function W(h){return c(h)==="[object Set]"}W.working=typeof Set<"u"&&W(new Set);function de(h){return typeof Set>"u"?!1:W.working?W(h):h instanceof Set}r.isSet=de;function ue(h){return c(h)==="[object WeakMap]"}ue.working=typeof WeakMap<"u"&&ue(new WeakMap);function ve(h){return typeof WeakMap>"u"?!1:ue.working?ue(h):h instanceof WeakMap}r.isWeakMap=ve;function Y(h){return c(h)==="[object WeakSet]"}Y.working=typeof WeakSet<"u"&&Y(new WeakSet);function H(h){return Y(h)}r.isWeakSet=H;function fe(h){return c(h)==="[object ArrayBuffer]"}fe.working=typeof ArrayBuffer<"u"&&fe(new ArrayBuffer);function be(h){return typeof ArrayBuffer>"u"?!1:fe.working?fe(h):h instanceof ArrayBuffer}r.isArrayBuffer=be;function f(h){return c(h)==="[object DataView]"}f.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&f(new DataView(new ArrayBuffer(1),0,1));function y(h){return typeof DataView>"u"?!1:f.working?f(h):h instanceof DataView}r.isDataView=y;var m=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function T(h){return c(h)==="[object SharedArrayBuffer]"}function O(h){return typeof m>"u"?!1:(typeof T.working>"u"&&(T.working=T(new m)),T.working?T(h):h instanceof m)}r.isSharedArrayBuffer=O;function I(h){return c(h)==="[object AsyncFunction]"}r.isAsyncFunction=I;function C(h){return c(h)==="[object Map Iterator]"}r.isMapIterator=C;function R(h){return c(h)==="[object Set Iterator]"}r.isSetIterator=R;function b(h){return c(h)==="[object Generator]"}r.isGeneratorObject=b;function j(h){return c(h)==="[object WebAssembly.Module]"}r.isWebAssemblyCompiledModule=j;function N(h){return w(h,u)}r.isNumberObject=N;function L(h){return w(h,l)}r.isStringObject=L;function $(h){return w(h,p)}r.isBooleanObject=$;function K(h){return i&&w(h,d)}r.isBigIntObject=K;function V(h){return s&&w(h,E)}r.isSymbolObject=V;function we(h){return N(h)||L(h)||$(h)||K(h)||V(h)}r.isBoxedPrimitive=we;function Oe(h){return typeof Uint8Array<"u"&&(be(h)||O(h))}r.isAnyArrayBuffer=Oe,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(h){Object.defineProperty(r,h,{enumerable:!1,value:function(){throw new Error(h+" is not supported in userland")}})})})(Qe)),Qe}var Zt,vn;function wo(){return vn||(vn=1,Zt=function(t){return t&&typeof t=="object"&&typeof t.copy=="function"&&typeof t.fill=="function"&&typeof t.readUInt8=="function"}),Zt}var De={exports:{}},bn;function Ao(){return bn||(bn=1,typeof Object.create=="function"?De.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:De.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}),De.exports}var wn;function So(){return wn||(wn=1,(function(r){var t=Object.getOwnPropertyDescriptors||function(y){for(var m=Object.keys(y),T={},O=0;O<m.length;O++)T[m[O]]=Object.getOwnPropertyDescriptor(y,m[O]);return T},e=/%[sdj%]/g;r.format=function(f){if(!J(f)){for(var y=[],m=0;m<arguments.length;m++)y.push(i(arguments[m]));return y.join(" ")}for(var m=1,T=arguments,O=T.length,I=String(f).replace(e,function(R){if(R==="%%")return"%";if(m>=O)return R;switch(R){case"%s":return String(T[m++]);case"%d":return Number(T[m++]);case"%j":try{return JSON.stringify(T[m++])}catch{return"[Circular]"}default:return R}}),C=T[m];m<O;C=T[++m])v(C)||!oe(C)?I+=" "+C:I+=" "+i(C);return I},r.deprecate=function(f,y){if(typeof X<"u"&&X.noDeprecation===!0)return f;if(typeof X>"u")return function(){return r.deprecate(f,y).apply(this,arguments)};var m=!1;function T(){if(!m){if(X.throwDeprecation)throw new Error(y);X.traceDeprecation?console.trace(y):console.error(y),m=!0}return f.apply(this,arguments)}return T};var n={},a=/^$/;if(X.env.NODE_DEBUG){var o=X.env.NODE_DEBUG;o=o.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),a=new RegExp("^"+o+"$","i")}r.debuglog=function(f){if(f=f.toUpperCase(),!n[f])if(a.test(f)){var y=X.pid;n[f]=function(){var m=r.format.apply(r,arguments);console.error("%s %d: %s",f,y,m)}}else n[f]=function(){};return n[f]};function i(f,y){var m={seen:[],stylize:c};return arguments.length>=3&&(m.depth=arguments[2]),arguments.length>=4&&(m.colors=arguments[3]),F(y)?m.showHidden=y:y&&r._extend(m,y),B(m.showHidden)&&(m.showHidden=!1),B(m.depth)&&(m.depth=2),B(m.colors)&&(m.colors=!1),B(m.customInspect)&&(m.customInspect=!0),m.colors&&(m.stylize=s),l(m,f,m.depth)}r.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function s(f,y){var m=i.styles[y];return m?"\x1B["+i.colors[m][0]+"m"+f+"\x1B["+i.colors[m][1]+"m":f}function c(f,y){return f}function u(f){var y={};return f.forEach(function(m,T){y[m]=!0}),y}function l(f,y,m){if(f.customInspect&&y&&G(y.inspect)&&y.inspect!==r.inspect&&!(y.constructor&&y.constructor.prototype===y)){var T=y.inspect(m,f);return J(T)||(T=l(f,T,m)),T}var O=p(f,y);if(O)return O;var I=Object.keys(y),C=u(I);if(f.showHidden&&(I=Object.getOwnPropertyNames(y)),Q(y)&&(I.indexOf("message")>=0||I.indexOf("description")>=0))return d(y);if(I.length===0){if(G(y)){var R=y.name?": "+y.name:"";return f.stylize("[Function"+R+"]","special")}if(ce(y))return f.stylize(RegExp.prototype.toString.call(y),"regexp");if(le(y))return f.stylize(Date.prototype.toString.call(y),"date");if(Q(y))return d(y)}var b="",j=!1,N=["{","}"];if(A(y)&&(j=!0,N=["[","]"]),G(y)){var L=y.name?": "+y.name:"";b=" [Function"+L+"]"}if(ce(y)&&(b=" "+RegExp.prototype.toString.call(y)),le(y)&&(b=" "+Date.prototype.toUTCString.call(y)),Q(y)&&(b=" "+d(y)),I.length===0&&(!j||y.length==0))return N[0]+b+N[1];if(m<0)return ce(y)?f.stylize(RegExp.prototype.toString.call(y),"regexp"):f.stylize("[Object]","special");f.seen.push(y);var $;return j?$=E(f,y,m,C,I):$=I.map(function(K){return w(f,y,m,C,K,j)}),f.seen.pop(),g($,b,N)}function p(f,y){if(B(y))return f.stylize("undefined","undefined");if(J(y)){var m="'"+JSON.stringify(y).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return f.stylize(m,"string")}if(D(y))return f.stylize(""+y,"number");if(F(y))return f.stylize(""+y,"boolean");if(v(y))return f.stylize("null","null")}function d(f){return"["+Error.prototype.toString.call(f)+"]"}function E(f,y,m,T,O){for(var I=[],C=0,R=y.length;C<R;++C)Y(y,String(C))?I.push(w(f,y,m,T,String(C),!0)):I.push("");return O.forEach(function(b){b.match(/^\d+$/)||I.push(w(f,y,m,T,b,!0))}),I}function w(f,y,m,T,O,I){var C,R,b;if(b=Object.getOwnPropertyDescriptor(y,O)||{value:y[O]},b.get?b.set?R=f.stylize("[Getter/Setter]","special"):R=f.stylize("[Getter]","special"):b.set&&(R=f.stylize("[Setter]","special")),Y(T,O)||(C="["+O+"]"),R||(f.seen.indexOf(b.value)<0?(v(m)?R=l(f,b.value,null):R=l(f,b.value,m-1),R.indexOf(`
`)>-1&&(I?R=R.split(`
`).map(function(j){return"  "+j}).join(`
`).slice(2):R=`
`+R.split(`
`).map(function(j){return"   "+j}).join(`
`))):R=f.stylize("[Circular]","special")),B(C)){if(I&&O.match(/^\d+$/))return R;C=JSON.stringify(""+O),C.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(C=C.slice(1,-1),C=f.stylize(C,"name")):(C=C.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),C=f.stylize(C,"string"))}return C+": "+R}function g(f,y,m){var T=f.reduce(function(O,I){return I.indexOf(`
`)>=0,O+I.replace(/\u001b\[\d\d?m/g,"").length+1},0);return T>60?m[0]+(y===""?"":y+`
 `)+" "+f.join(`,
  `)+" "+m[1]:m[0]+y+" "+f.join(", ")+" "+m[1]}r.types=bo();function A(f){return Array.isArray(f)}r.isArray=A;function F(f){return typeof f=="boolean"}r.isBoolean=F;function v(f){return f===null}r.isNull=v;function S(f){return f==null}r.isNullOrUndefined=S;function D(f){return typeof f=="number"}r.isNumber=D;function J(f){return typeof f=="string"}r.isString=J;function z(f){return typeof f=="symbol"}r.isSymbol=z;function B(f){return f===void 0}r.isUndefined=B;function ce(f){return oe(f)&&W(f)==="[object RegExp]"}r.isRegExp=ce,r.types.isRegExp=ce;function oe(f){return typeof f=="object"&&f!==null}r.isObject=oe;function le(f){return oe(f)&&W(f)==="[object Date]"}r.isDate=le,r.types.isDate=le;function Q(f){return oe(f)&&(W(f)==="[object Error]"||f instanceof Error)}r.isError=Q,r.types.isNativeError=Q;function G(f){return typeof f=="function"}r.isFunction=G;function Ce(f){return f===null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||typeof f=="symbol"||typeof f>"u"}r.isPrimitive=Ce,r.isBuffer=wo();function W(f){return Object.prototype.toString.call(f)}function de(f){return f<10?"0"+f.toString(10):f.toString(10)}var ue=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function ve(){var f=new Date,y=[de(f.getHours()),de(f.getMinutes()),de(f.getSeconds())].join(":");return[f.getDate(),ue[f.getMonth()],y].join(" ")}r.log=function(){console.log("%s - %s",ve(),r.format.apply(r,arguments))},r.inherits=Ao(),r._extend=function(f,y){if(!y||!oe(y))return f;for(var m=Object.keys(y),T=m.length;T--;)f[m[T]]=y[m[T]];return f};function Y(f,y){return Object.prototype.hasOwnProperty.call(f,y)}var H=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;r.promisify=function(y){if(typeof y!="function")throw new TypeError('The "original" argument must be of type Function');if(H&&y[H]){var m=y[H];if(typeof m!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(m,H,{value:m,enumerable:!1,writable:!1,configurable:!0}),m}function m(){for(var T,O,I=new Promise(function(b,j){T=b,O=j}),C=[],R=0;R<arguments.length;R++)C.push(arguments[R]);C.push(function(b,j){b?O(b):T(j)});try{y.apply(this,C)}catch(b){O(b)}return I}return Object.setPrototypeOf(m,Object.getPrototypeOf(y)),H&&Object.defineProperty(m,H,{value:m,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(m,t(y))},r.promisify.custom=H;function fe(f,y){if(!f){var m=new Error("Promise was rejected with a falsy value");m.reason=f,f=m}return y(f)}function be(f){if(typeof f!="function")throw new TypeError('The "original" argument must be of type Function');function y(){for(var m=[],T=0;T<arguments.length;T++)m.push(arguments[T]);var O=m.pop();if(typeof O!="function")throw new TypeError("The last argument must be of type Function");var I=this,C=function(){return O.apply(I,arguments)};f.apply(this,m).then(function(R){X.nextTick(C.bind(null,null,R))},function(R){X.nextTick(fe.bind(null,R,C))})}return Object.setPrototypeOf(y,Object.getPrototypeOf(f)),Object.defineProperties(y,t(f)),y}r.callbackify=be})(Je)),Je}var Ro=So();class M extends Nn{constructor(t,e){super(t,e)}execute2(t,e,n){if(!Eo(this))return new P(this,[]);let a;try{a=this.execute(t,e)}catch(o){return new P(this,[],Ro.inspect(o))}return Po(this)&&(a=this.suppress(a,e)),a=To(a,n),a}}function To(r,t){if(!t||t.length===0)return r;const e=r.details.filter(n=>!t.includes(n.name));return r.details=e,r.occurs=e.length>0,r}const An=r=>typeof r=="function";function Po(r){return An(r.suppress)}function Eo(r){return An(r.execute)}class Kt extends M{execute(t){const e=this.findLoopElements(t);if(!e.length)return new P(this,[]);const a=this.findStatementsInLoops(t,e).map(o=>new U(o));return new P(this,a)}findLoopElements(t){var e;return((e=t.elements)==null?void 0:e.filter(n=>n.subtype==="loops"))||[]}findLoopEnd(t){var e;return((e=t.element.noMoreValuesConnector)==null?void 0:e.targetReference)??t.name}findStatementsInLoops(t,e){const n=[],a=this.getStatementTypes(),o=i=>{a.includes(i.subtype)&&n.push(i)};for(const i of e){const s=this.findLoopEnd(i);new xe().traverseFlow(t,i.name,o,s)}return n}}class Fo extends Kt{constructor(){super({autoFixable:!1,description:"To prevent exceeding Apex governor limits, it is advisable to consolidate and bulkify your apex calls, utilize a single action call containing a collection variable at the end of the loop.",docRefs:[{label:"Invocable Method Considerations",path:"https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_classes_annotation_InvocableMethod.htm"}],isConfigurable:!1,label:"**Beta** Action Calls In Loop",name:"ActionCallsInLoop",supportedTypes:x.backEndTypes},{severity:"warning"})}getStatementTypes(){return["actionCalls","apexPluginCalls"]}}class Co extends M{constructor(){super({name:"APIVersion",label:"Outdated API Version",description:"Introducing newer API components may lead to unexpected issues with older versions of Flows, as they might not align with the underlying mechanics. Starting from API version 50.0, the 'Api Version' attribute has been readily available on the Flow Object. To ensure smooth operation and reduce discrepancies between API versions, it is strongly advised to regularly update and maintain them.",supportedTypes:x.allTypes(),docRefs:[],isConfigurable:!0,autoFixable:!1})}execute(t,e){let n=null;t.xmldata.apiVersion&&(n=+t.xmldata.apiVersion);const a=[];return n?(e&&e.expression&&(new Function(`return ${n}${e.expression};`)()||a.push(new U(new Z(`${n}`,"apiVersion",e.expression)))),new P(this,a)):(a.push(new U(new Z("API Version <49","apiVersion","<49"))),new P(this,a))}}class Oo extends M{constructor(){super({name:"AutoLayout",label:"Auto-Layout Mode",description:"With Canvas Mode set to Auto-Layout, Elements are spaced, connected, and aligned automatically, keeping your Flow neatly organized thus saving you time.",supportedTypes:x.allTypes(),docRefs:[],isConfigurable:!0,autoFixable:!1})}execute(t,e){var n;if(t.processMetadataValues){const a=t.xmldata.processMetadataValues.find(i=>i.name==="CanvasMode");return a.value&&typeof a.value=="object"&&a.value.stringValue&&a.value.stringValue==="AUTO_LAYOUT_CANVAS"?new P(this,[]):new P(this,[new U(new Z((n=a.value)==null?void 0:n.stringValue,"CanvasMode","!== AUTO_LAYOUT_CANVAS"))])}return new P(this,[])}}class xo extends M{constructor(){super({name:"CopyAPIName",label:"Copy API Name",description:"Maintaining multiple elements with a similar name, like 'Copy_X_Of_Element,' can diminish the overall readability of your Flow. When copying and pasting these elements, it's crucial to remember to update the API name of the newly created copy.",supportedTypes:x.allTypes(),docRefs:[],isConfigurable:!1,autoFixable:!1})}execute(t){const e=t.elements.filter(o=>o instanceof re),n=[];for(const o of e)new RegExp("Copy_[0-9]+_of_[A-Za-z0-9]+").test(o.name)&&n.push(o);const a=[];for(const o of n)a.push(new U(o));return new P(this,a)}}class Io extends M{constructor(){super({name:"CyclomaticComplexity",label:"Cyclomatic Complexity",description:"The number of loops and decision rules, plus the number of decisions. Use a combination of 1) subflows and 2) breaking flows into multiple concise trigger ordered flows, to reduce the cyclomatic complexity within a single flow, ensuring maintainability and simplicity.",supportedTypes:x.backEndTypes,docRefs:[{label:"Cyclomatic complexity is a software metric used to indicate the complexity of a program. It is a quantitative measure of the number of linearly independent paths through a program's source code.",path:"https://en.wikipedia.org/wiki/Cyclomatic_complexity"}],isConfigurable:!0,autoFixable:!1},{severity:"note"}),this.defaultThreshold=25,this.cyclomaticComplexityUnit=0}execute(t,e){var c,u;const n=(e==null?void 0:e.threshold)||this.defaultThreshold;let a=1;const o=(c=t==null?void 0:t.elements)==null?void 0:c.filter(l=>l.subtype==="decisions"),i=(u=t==null?void 0:t.elements)==null?void 0:u.filter(l=>l.subtype==="loops");for(const l of o||[]){const p=l.element.rules;Array.isArray(p)?a+=p.length+1:a+=1}a+=(i==null?void 0:i.length)??0,this.cyclomaticComplexityUnit=a;const s=[];return a>n&&s.push(new U(new Z(`${a}`,"CyclomaticComplexity",`>${n}`))),new P(this,s)}}class jo extends Kt{constructor(){super({autoFixable:!1,description:"To prevent exceeding Apex governor limits, it is advisable to consolidate all your database operations, including record creation, updates, or deletions, at the conclusion of the flow.",docRefs:[{label:"Flow Best Practices",path:"https://help.salesforce.com/s/articleView?id=sf.flow_prep_bestpractices.htm&type=5"}],isConfigurable:!1,label:"DML Statement In A Loop",name:"DMLStatementInLoop",supportedTypes:x.backEndTypes})}getStatementTypes(){return["recordDeletes","recordUpdates","recordCreates"]}}class Bo extends M{constructor(){super({name:"DuplicateDMLOperation",label:"Duplicate DML Operation",description:"When the flow executes database changes or actions between two screens, it's important to prevent users from navigating back between screens. Failure to do so may result in duplicate database operations being performed within the flow.",supportedTypes:x.visualTypes,docRefs:[],isConfigurable:!1,autoFixable:!1})}execute(t){const e=t.elements.filter(l=>l instanceof re),n=[],a=[],o=[],i=this.findStart(t);if(!i||i===-1)throw"Can not find starting element";let s=!1,c=[i];do if(c=c.filter(l=>!n.includes(l)),c.length>0){for(const[l,p]of e.entries())if(c.includes(l)){const d=[];if(p.connectors&&p.connectors.length>0)for(const E of p.connectors)E.reference&&d.push(E.reference);if(s=this.flagDML(p,s),d.length>0){const E=e.filter(w=>d.includes(w.name));for(const w of E){const g=e.findIndex(A=>w.name===A.name);w.subtype==="screens"&&s&&w.element.allowBack&&w.element.allowBack=="true"&&w.element.showFooter=="true"&&o.push(w),n.includes(g)||c.push(g)}}n.push(l)}}else for(const l of e.keys())n.includes(l)||a.push(l);while(n.length+a.length<e.length);const u=[];for(const l of o)u.push(new U(l));return new P(this,u)}flagDML(t,e){return["recordDeletes","recordUpdates","recordCreates"].includes(t.subtype)?!0:e===!0&&t.subtype==="screens"&&t.element.allowBack&&t.element.allowBack=="true"?!1:e}findStart(t){const e=t.elements.filter(a=>a instanceof re);let n;return t.startElementReference?n=e.findIndex(a=>a.name==t.startElementReference):n=e.findIndex(a=>a.subtype==="start"),n}}class No extends M{constructor(){super({autoFixable:!1,description:"Descriptions play a vital role in documentation. We highly recommend including details about where they are used and their intended purpose.",docRefs:[],isConfigurable:!1,label:"Missing Flow Description",name:"FlowDescription",supportedTypes:[...x.backEndTypes,...x.visualTypes]})}execute(t){var n;return!((n=t.xmldata)!=null&&n.description)?new P(this,[new U(new Z("undefined","description","!==null"))]):new P(this,[])}}class Do extends M{constructor(){super({autoFixable:!1,description:"The readability of a flow is of utmost importance. Establishing a naming convention for the Flow Name significantly enhances findability, searchability, and maintains overall consistency. It is advisable to include at least a domain and a brief description of the actions carried out in the flow, for instance, 'Service_OrderFulfillment'.",docRefs:[{label:"Naming your Flows is more critical than ever. By Stephen Church",path:"https://www.linkedin.com/posts/stephen-n-church_naming-your-flows-this-is-more-critical-activity-7099733198175158274-1sPx?utm_source=share&utm_medium=member_desktop"}],isConfigurable:!0,label:"Flow Naming Convention",name:"FlowName",supportedTypes:x.allTypes()})}execute(t,e){const a=e&&e.expression?e.expression:"[A-Za-z0-9]+_[A-Za-z0-9]+",o=t.name;return new RegExp(a).test(o)?new P(this,[]):new P(this,[new U(new Z(o,"name",a))])}}class _o extends M{constructor(){super({autoFixable:!1,description:"Following the principle of least privilege (PoLP), avoid using Get Records with 'Automatically store all fields' unless necessary.",docRefs:[{label:"SOQL and SOSL | Best Practices for Deployments with Large Data Volumes",path:"https://developer.salesforce.com/docs/atlas.en-us.salesforce_large_data_volumes_bp.meta/salesforce_large_data_volumes_bp/ldv_deployments_best_practices_soql_and_sosl.htm"},{label:"Indexes | Best Practices",path:"https://developer.salesforce.com/docs/atlas.en-us.salesforce_large_data_volumes_bp.meta/salesforce_large_data_volumes_bp/ldv_deployments_infrastructure_indexes.htm"}],isConfigurable:!1,label:"Get Record All Fields",name:"GetRecordAllFields",supportedTypes:x.allTypes()},{severity:"warning"})}execute(t){var o;const e=[],n=(o=t.elements)==null?void 0:o.filter(i=>i.subtype==="recordLookups");if(n==null||n.length===0)return new P(this,e);const a=n.filter(i=>{const s=i;if(!(typeof s.element=="object"))return!1;const u=s.element,l="storeOutputAutomatically"in u&&u.storeOutputAutomatically,p="queriedFields"in u&&u.queriedFields.length>0;return l&&!p}).map(i=>{const s=i;return new U(s)});return e.push(...a),new P(this,e)}}class qo extends M{constructor(){super({name:"HardcodedId",label:"Hardcoded Id",description:"Avoid hard-coding IDs as they are org-specific. Instead, pass them into variables at the start of the flow. You can achieve this by utilizing merge fields in URL parameters or employing a Get Records element.",supportedTypes:x.allTypes(),docRefs:[{label:"Flow Best Practices",path:"https://help.salesforce.com/s/articleView?id=sf.flow_prep_bestpractices.htm&type=5"},{label:"Don't hard code Record Type IDs in Flow. By Stephen Church.",path:"https://www.linkedin.com/feed/update/urn:li:activity:6947530300012826624/?updateEntityUrn=urn%3Ali%3Afs_feedUpdate%3A%28V2%2Curn%3Ali%3Aactivity%3A6947530300012826624%29"}],isConfigurable:!1,autoFixable:!1})}execute(t){const e=[],n=/\b[a-zA-Z0-9]{5}0[a-zA-Z0-9]{9}([a-zA-Z0-9]{3})?\b/g;for(const o of t.elements){const i=JSON.stringify(o);n.test(i)&&e.push(o)}const a=e.map(o=>new U(o));return new P(this,a)}}class Uo extends M{constructor(){super({autoFixable:!1,description:"Avoid hard-coding URLs as they are org-specific. Instead, use a $API formula (preferred) or you can use an environment-specific such as custom labels, custom metadata, or custom settings.",docRefs:[{label:"The Ultimate Guide to Salesforce Flow Best Practices",path:"https://admin.salesforce.com/blog/2021/the-ultimate-guide-to-flow-best-practices-and-standards"},{label:"Why You Should Avoid Hard Coding and Three Alternative Solutions",path:"https://admin.salesforce.com/blog/2021/why-you-should-avoid-hard-coding-and-three-alternative-solutions"}],isConfigurable:!1,label:"Hardcoded Url",name:"HardcodedUrl",supportedTypes:x.allTypes()},{severity:"warning"})}execute(t){const e=[];if(!t.elements||t.elements.length===0)return new P(this,e);const n=/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}force\.com/g;for(const a of t.elements){const o=JSON.stringify(a);n.test(o)&&e.push(new U(a))}return new P(this,e)}}class Mo extends M{constructor(){super({name:"InactiveFlow",label:"Inactive Flow",description:"Like cleaning out your closet: deleting unused flows is essential. Inactive flows can still cause trouble, like accidentally deleting records during testing, or being activated as subflows within parent flows.",supportedTypes:x.allTypes(),docRefs:[],isConfigurable:!1,autoFixable:!1})}execute(t){const e=[];return t.status!=="Active"&&e.push(new U(new Z(t.status,"status","!= Active"))),new P(this,e)}}class ko extends M{constructor(){super({autoFixable:!1,description:"At times, a flow may fail to execute a configured operation as intended. By default, the flow displays an error message to the user and notifies the admin who created the flow via email. However, you can customize this behavior by incorporating a Fault Path.",docRefs:[{label:"Flow Best Practices",path:"https://help.salesforce.com/s/articleView?id=sf.flow_prep_bestpractices.htm&type=5"}],isConfigurable:!1,label:"Missing Fault Path",name:"MissingFaultPath",supportedTypes:[...x.backEndTypes,...x.visualTypes],suppressionElement:"actionName"}),this.applicableElements=["recordLookups","recordDeletes","recordUpdates","recordCreates","waits","actionCalls"]}isValidSubtype(t){var e;if(!this.applicableElements.includes(t.subtype))return!1;if(t.subtype==="waits"){const n=(e=t.element)==null?void 0:e.elementSubtype;return!["WaitDuration","WaitDate"].includes(n)}return!0}execute(t){var s;const e=new xe,n=[],a=((s=t.elements)==null?void 0:s.filter(c=>{const u=c;return this.isValidSubtype(u)})).map(c=>c.name),o=t.start.triggerType==="RecordBeforeSave",i=c=>{var u;if(!((u=c==null?void 0:c.connectors)!=null&&u.find(l=>l.type==="faultConnector"))&&a.includes(c.name)){if(o&&c.subtype==="recordUpdates")return;this.isPartOfFaultHandlingFlow(c,t)||n.push(new U(c))}};return e.traverseFlow(t,t.startReference,i),new P(this,n)}suppress(t,e){var o;const n=[],a=this.suppressionElement;for(const i of t.details)"violation"in i&&"element"in i.violation&&typeof i.violation.element=="object"&&!Array.isArray(i.violation.element)&&a in i.violation.element&&((o=e==null?void 0:e.suppressions)!=null&&o.includes(i.violation.element[a]))||n.push(i);return new P(this,n)}isPartOfFaultHandlingFlow(t,e){var a,o;const n=(a=e.elements)==null?void 0:a.filter(i=>i instanceof re);for(const i of n)if(i!==t&&(o=i.connectors)!=null&&o.find(s=>s.type==="faultConnector"&&s.reference===t.name))return!0;return!1}}class Lo extends M{constructor(){super({autoFixable:!1,description:"When a Get Records operation doesn't find any data, it returns null. To ensure data validation, utilize a decision element on the operation result variable to check for a non-null result.",docRefs:[],isConfigurable:!1,label:"Missing Null Handler",name:"MissingNullHandler",supportedTypes:[...x.backEndTypes,...x.visualTypes]})}execute(t){const e=["recordLookups"],n=t.elements.filter(s=>s.metaType==="node"&&e.includes(s.subtype)),a=t.elements.filter(s=>s.metaType==="node"&&s.subtype==="decisions"),o=[];for(const s of n){const c=s.name;let u=!1,l=[];if(s.element.storeOutputAutomatically)l=[c];else if(s.element.outputReference)l=s.element.outputReference;else if(s.element.outputAssignments){const d=s.element.outputAssignments;for(const E of d)l.push(E.assignToReference)}if(t.elements.some(d=>{if(d.name===s.name)return!1;const E=JSON.stringify(d.element);return l.some(w=>E.includes(`"${w}"`)||E.includes(`"${w}.`))})){for(const d of a){let E=d.element.rules;Array.isArray(E)||(E=[E]);for(const g of E){let A=g.conditions;Array.isArray(A)||(A=[A]);for(const v of A){let S=!1,D=!1,J=!1;if(v.leftValueReference&&v.leftValueReference.length>0){const z=v.leftValueReference;for(const B of l)if(S=z.startsWith(B),S)break}v.operator&&(!Array.isArray(v.operator)||v.operator.length>0)&&(D=v.operator==="IsNull"),v.rightValue&&(!Array.isArray(v.rightValue)||v.rightValue.length>0)&&v.rightValue.booleanValue&&(!Array.isArray(v.rightValue.booleanValue)||v.rightValue.booleanValue.length>0)&&(J=v.rightValue.booleanValue.toLowerCase()==="false"),S&&D&&J&&(u=!0)}}}u||o.push(s)}}const i=[];for(const s of o)i.push(new U(s));return new P(this,i)}}class $o extends M{constructor(){super({name:"ProcessBuilder",label:"No Process Builder",description:"Salesforce is transitioning away from Workflow Rules and Process Builder in favor of Flow. Ensure you're prepared for this transition by migrating your organization's automation to Flow. Refer to official documentation for more information on the transition process and tools available.",supportedTypes:x.processBuilder,docRefs:[{label:"Process Builder Retirement",path:"https://help.salesforce.com/s/articleView?id=000389396&type=1"}],isConfigurable:!0,autoFixable:!1})}execute(t,e){return new P(this,[new U(new Z("Workflow","processType","== Workflow"))])}}class Vo extends M{constructor(){super({autoFixable:!1,description:"After updates are meant to be used for record modifications that are not the same record that triggered the flow. Using after updates on the same record can lead to recursion and unexpected behavior. Consider using before save flows for same record updates.",docRefs:[{label:"Learn about same record field updates",path:"https://architect.salesforce.com/decision-guides/trigger-automation#Same_Record_Field_Updates"}],isConfigurable:!1,label:"Recursive After Update",name:"RecursiveAfterUpdate",supportedTypes:[...x.backEndTypes]},{severity:"warning"}),this.qualifiedRecordTriggerTypes=new Set(["Create","CreateAndUpdate","Update"])}execute(t){var s,c,u,l,p;const e=[],n=((s=t.start)==null?void 0:s.triggerType)==="RecordAfterSave",a=this.qualifiedRecordTriggerTypes.has((c=t.start)==null?void 0:c.recordTriggerType);if(!n||!a)return new P(this,e);const o=(u=t.elements)==null?void 0:u.filter(d=>d.subtype==="recordUpdates");if(o==null||typeof o[Symbol.iterator]!="function")return new P(this,e);for(const d of o)typeof d.element=="object"&&"inputReference"in d.element&&d.element.inputReference==="$Record"&&e.push(new U(d));const i=(p=(l=t.elements)==null?void 0:l.filter(d=>d.subtype==="recordLookups"&&typeof d.element=="object"&&"object"in d.element&&t.start.object===d.element.object))==null?void 0:p.map(d=>d.name);if(i==null||typeof i[Symbol.iterator]!="function")return new P(this,e);for(const d of o)typeof d.element=="object"&&"inputReference"in d.element&&i.includes(d.element.inputReference)&&e.push(new U(d));return new P(this,e)}}class Go extends M{constructor(){super({name:"SameRecordFieldUpdates",label:"Same Record Field Updates",description:"Before-save same-record field updates allows you to update the record using variable assignments to `$Record`. This is significantly faster than doing another DML on the same-record that triggered the flow",supportedTypes:[...x.backEndTypes],docRefs:[{label:"Learn about same record field updates",path:"https://architect.salesforce.com/decision-guides/trigger-automation#Same_Record_Field_Updates"}],isConfigurable:!1,autoFixable:!1},{severity:"warning"}),this.qualifiedRecordTriggerTypes=new Set(["Create","Update","CreateAndUpdate"])}execute(t){var i,s,c;const e=[],n=((i=t.start)==null?void 0:i.triggerType)==="RecordBeforeSave",a=this.qualifiedRecordTriggerTypes.has((s=t.start)==null?void 0:s.recordTriggerType);if(!n||!a)return new P(this,e);const o=(c=t.elements)==null?void 0:c.filter(u=>u.subtype==="recordUpdates");if(o==null||typeof o[Symbol.iterator]!="function")return new P(this,e);for(const u of o)typeof u.element=="object"&&"inputReference"in u.element&&u.element.inputReference==="$Record"&&e.push(new U(u));return new P(this,e)}}class Wo extends Kt{constructor(){super({autoFixable:!1,description:"To prevent exceeding Apex governor limits, it is advisable to consolidate all your SOQL queries at the conclusion of the flow.",docRefs:[{label:"Flow Best Practices",path:"https://help.salesforce.com/s/articleView?id=sf.flow_prep_bestpractices.htm&type=5"}],isConfigurable:!1,label:"SOQL Query In A Loop",name:"SOQLQueryInLoop",supportedTypes:x.backEndTypes})}getStatementTypes(){return["recordLookups"]}}class zo extends M{constructor(){super({name:"TriggerOrder",label:"Trigger Order",description:"With flow trigger ordering, introduced in Spring '22, admins can now assign a priority value to their flows and guarantee their execution order. This priority value is not an absolute value, so the values need not be sequentially numbered as 1, 2, 3, and so on.",supportedTypes:[x.autolaunchedType],docRefs:[{label:"Learn more about flow ordering orchestration",path:"https://architect.salesforce.com/decision-guides/trigger-automation#Ordering___Orchestration"}],isConfigurable:!1,autoFixable:!1},{severity:"note"}),this.qualifiedRecordTriggerTypes=new Set(["Create","Update"])}execute(t){const e=[];return"object"in t.start?(t.triggerOrder||e.push(new U(new Z("TriggerOrder","TriggerOrder","10, 20, 30 ..."))),new P(this,e)):new P(this,e)}}class Ho extends M{constructor(){super({autoFixable:!0,description:"To maintain the efficiency and manageability of your Flow, it's best to avoid including unconnected elements that are not in use.",docRefs:[],isConfigurable:!1,label:"Unconnected Element",name:"UnconnectedElement",supportedTypes:[...x.backEndTypes,...x.visualTypes]})}execute(t){const e=new Set,n=c=>{e.add(c.name)},a=t.elements.filter(c=>c instanceof re),o=this.findStart(a);o!==-1&&new xe().traverseFlow(t,a[o].name,n);const s=a.filter(c=>!e.has(c.name)).map(c=>new U(c));return new P(this,s)}findStart(t){return t.findIndex(e=>e.subtype==="start")}}class Jo extends M{constructor(){super({name:"UnsafeRunningContext",label:"Unsafe Running Context",description:"This flow is configured to run in System Mode without Sharing. This system context grants all running users the permission to view and edit all data in your org. Running a flow in System Mode without Sharing can lead to unsafe data access.",supportedTypes:[...x.backEndTypes,...x.visualTypes],docRefs:[{label:"Learn about data safety when running flows in system context in Salesforce Help",path:"https://help.salesforce.com/s/articleView?id=sf.flow_distribute_context_data_safety_system_context.htm&type=5"}],isConfigurable:!1,autoFixable:!1},{severity:"warning"})}execute(t){const e="runInMode"in t.xmldata,n=e?t.xmldata.runInMode:void 0,a="SystemModeWithoutSharing",o=[];return e&&n===a&&o.push(new U(new Z(n,"runInMode",`== ${a}`))),new P(this,o)}}class Qo extends M{constructor(){super({name:"UnusedVariable",label:"Unused Variable",description:"To maintain the efficiency and manageability of your Flow, it's advisable to avoid including unconnected variables that are not in use.",supportedTypes:[...x.backEndTypes,...x.visualTypes],docRefs:[],isConfigurable:!1,autoFixable:!0})}execute(t){const e=[];for(const a of t.elements.filter(o=>o instanceof Re)){const o=a.name;if([...JSON.stringify(t.elements.filter(i=>i instanceof re)).matchAll(new RegExp(o,"gi"))].map(i=>i.index).length===0&&[...JSON.stringify(t.elements.filter(i=>i instanceof je)).matchAll(new RegExp(o,"gi"))].map(i=>i.index).length===0){const i=[...JSON.stringify(a).matchAll(new RegExp(a.name,"gi"))].map(c=>c.index);[...JSON.stringify(t.elements.filter(c=>c instanceof Re)).matchAll(new RegExp(o,"gi"))].map(c=>c.index).length===i.length&&e.push(a)}}const n=[];for(const a of e)n.push(new U(a));return new P(this,n)}}const _e={APIVersion:Co,AutoLayout:Oo,CopyAPIName:xo,CyclomaticComplexity:Io,DMLStatementInLoop:jo,DuplicateDMLOperation:Bo,FlowDescription:No,FlowName:Do,GetRecordAllFields:_o,HardcodedId:qo,HardcodedUrl:Uo,InactiveFlow:Mo,MissingFaultPath:ko,MissingNullHandler:Lo,ProcessBuilder:$o,RecursiveAfterUpdate:Vo,SameRecordFieldUpdates:Go,SOQLQueryInLoop:Wo,TriggerOrder:zo,UnconnectedElement:Ho,UnsafeRunningContext:Jo,UnusedVariable:Qo},Fe={ActionCallsInLoop:Fo};class qe{constructor(t){return!_e.hasOwnProperty(t)&&Fe.hasOwnProperty(t)?new Fe[t]:new _e[t]}}function Ue(r,t){var a;const e=[],n=(t==null?void 0:t.betamode)===!0;if(r&&r instanceof Map)for(const o of r.keys()){let i="warning";try{const s=(a=r.get(o))==null?void 0:a.severity;s&&(s==="error"||s==="warning"||s==="note")&&(i=s);const c=new qe(o);s&&(c.severity=i),e.push(c)}catch(s){console.log(s.message)}}else for(const o in _e){const i=new qe(o);e.push(i)}if(n){for(const o in Fe)if(!e.some(i=>i.name===o)){const i=new qe(o);e.push(i)}}return e}function Xo(r,t){if(r&&r.length>0){const e=new Map(r.map(n=>[n,{severity:"error"}]));return Ue(e,t)}else return Ue(void 0,t)}function Yo(){return Zo()}function Zo(){return Object.values(Fe).map(r=>new r)}var er,Sn;function Ko(){if(Sn)return er;Sn=1;var r=null;return er=r,er}var ei=Ko();async function ti(r){const t=[],e=new he.XMLParser({attributeNamePrefix:"@_",ignoreAttributes:!1,ignoreNameSpace:!1,parseTagValue:!1,textNodeName:"#text"});for(const n of r)try{const a=Ae.normalize(n),o=await ei.promises.readFile(a,"utf8"),s=e.parse(o).Flow;t.push(new He(n,new We(n,s)))}catch(a){t.push(new He(n,void 0,a.message??a.toString()))}return t}function ri(r,t){const e=r.map(a=>a.flow),n=[];for(const a of e)n.push(oi(a,t));return n}function ni(r){const t=ii(r);let e={..._e,...Fe};return r!=null&&r.rules&&Object.keys(r.rules).length>0&&(e=Object.entries(e).reduce((n,[a,o])=>{var i;return(i=r==null?void 0:r.rules)!=null&&i[a]&&(n[a]=o),n},{})),[e,t]}function oi(r,t){var o,i,s,c;const[e,n]=ni(t),a=[];for(const[u]of Object.entries(e)){const l=new qe(u);if(!l.supportedTypes.includes(r.type)||((o=n==null?void 0:n[u])==null?void 0:o.disabled)===!0){a.push(new P(l,[]));continue}(i=n==null?void 0:n[u])!=null&&i.severity&&(l.severity=n[u].severity);const p=r.name,d=n[u]??{},E=((c=(s=t==null?void 0:t.exceptions)==null?void 0:s[p])==null?void 0:c[u])??[];a.push(l.execute2(r,d,E))}return new ze(r,a)}function ii(r){const t=(r==null?void 0:r.rules)??{};return Object.entries(t).reduce((n,[a,o])=>({...n,[a]:o}),{})}const{IS_NEW_SCAN_ENABLED:ai,OVERRIDE_CONFIG:Rn}=X.env;function si(r,t){if(ai==="true"&&Rn!==null&&Rn!==void 0)return ri(r,t);const e=[];for(const a of r)!a.errorMessage&&a.flow&&e.push(a.flow);let n;return t!=null&&t.rules&&Object.entries(t.rules).length>0?n=Tn(e,t):n=Tn(e),ci(n,t),n}function Tn(r,t){const e=[];let n=[];if(t&&t.rules){const a=new Map;for(const[o,i]of Object.entries(t.rules))a.set(o,i);n=Ue(a)}else n=Ue();for(const a of r){const o=[];for(const i of n)try{if(i.supportedTypes.includes(a.type)){let s;t&&t.rules&&t.rules[i.name]&&(s=t.rules[i.name]);const c=s&&Object.keys(s).length>0?i.execute(a,s):i.execute(a);c.severity!==i.severity&&(c.severity=i.severity),o.push(c)}else o.push(new P(i,[]))}catch(s){const c=`Something went wrong while executing ${i.name} in the Flow: ${a.name} with error ${s}`;o.push(new P(i,[],c))}e.push(new ze(a,o))}return e}function ci(r,t){if(!(t!=null&&t.exceptions))return;const e=(n,a)=>{const o=n.details.filter(i=>!a.includes(i.name));n.details=o,n.occurs=o.length>0};for(const[n,a]of Object.entries(t.exceptions)){const o=r.find(i=>i.flow.name===n);if(o)for(const i of o.ruleResults){const s=a[i.ruleName];s&&e(i,s)}}}_.AdvancedRule=M,_.Compiler=xe,_.Flow=We,_.FlowAttribute=Z,_.FlowElement=Se,_.FlowNode=re,_.FlowResource=je,_.FlowType=x,_.FlowVariable=Re,_.ParsedFlow=He,_.ResultDetails=U,_.RuleResult=P,_.ScanResult=ze,_.exportDetails=Pn,_.exportSarif=En,_.fix=qn,_.getBetaRules=Yo,_.getRules=Xo,_.parse=ti,_.scan=si,Object.defineProperty(_,Symbol.toStringTag,{value:"Module"})}));
